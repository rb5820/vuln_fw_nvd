<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Main NVD Menu -->
    <menuitem 
        id="menu_nvd_root"
        name="NVD Vulnerability"
        sequence="50"
        web_icon="vuln_fw_nvd,static/description/icon.png"/>
    
    <!-- Configuration Menu -->
    <menuitem 
        id="menu_nvd_config"
        name="âš™ï¸ Configuration"
        parent="menu_nvd_root"
        sequence="100"/>
    
    <!-- Reporting Menu -->
    <menuitem 
        id="menu_nvd_reporting"
        name="ðŸ“Š Reporting"
        parent="menu_nvd_root"
        sequence="75"/>

    <!-- Webhook Actions -->
    <record id="action_vuln_fw_nvd_connector" model="ir.actions.act_window">
        <field name="name">Connectors</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">vuln.fw.nvd.api.connector</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>

    <!-- Vendor Actions -->
    <record id="action_vuln_fw_nvd_vendor" model="ir.actions.act_window">
        <field name="name">Vendors</field>
        <field name="res_model">vuln.fw.nvd.vendor</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first vendor
            </p>
            <p>
                Vendors are normalized entries representing software/hardware manufacturers.
                They are shared across all NVD modules (CVE, CPE, etc.).
            </p>
        </field>
    </record>

    <!-- Product Actions -->
    <record id="action_vuln_fw_nvd_product" model="ir.actions.act_window">
        <field name="name">Products</field>
        <field name="res_model">vuln.fw.nvd.product</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first product
            </p>
            <p>
                Products are normalized entries representing vendor products.
                They are shared across all NVD modules (CVE, CPE, etc.).
            </p>
        </field>
    </record>

    <record id="action_vuln_fw_nvd_webhook" model="ir.actions.act_window">
        <field name="name">Webhooks</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">vuln.fw.nvd.webhook</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>

    <record id="action_vuln_fw_nvd_webhook_receiver" model="ir.actions.act_window">
        <field name="name">Webhook Receivers</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">vuln.fw.nvd.webhook.receiver</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>

    <!-- Webhook Allowed Host Action -->
    <record id="action_vuln_fw_nvd_webhook_allowed_host" model="ir.actions.act_window">
        <field name="name">Webhook Allowed Hosts</field>
        <field name="res_model">vuln.fw.nvd.webhook.allowed.host</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first allowed webhook host
            </p>
            <p>
                Configure which hosts are allowed to send webhook requests to your vulnerability framework.
            </p>
        </field>
    </record>

    <!-- Webhook Blocked Host Action -->
    <record id="action_vuln_fw_nvd_webhook_blocked_host" model="ir.actions.act_window">
        <field name="name">Webhook Blocked Hosts</field>
        <field name="res_model">vuln.fw.nvd.webhook.blocked.host</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No blocked hosts yet
            </p>
            <p>
                Hosts that have been blocked due to unauthorized webhook attempts will appear here.
            </p>
        </field>
    </record>

    <!-- Webhook Log Action -->
    <record id="action_vuln_fw_nvd_webhook_log" model="ir.actions.act_window">
        <field name="name">Webhook Logs</field>
        <field name="res_model">vuln.fw.nvd.webhook.log</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No webhook logs yet
            </p>
            <p>
                Webhook request/response logs will appear here for monitoring and debugging.
            </p>
        </field>
    </record>

    <record id="action_vuln_fw_nvd_webhook_payload_queue" model="ir.actions.act_window">
        <field name="name">Payload Queue</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">vuln.fw.nvd.webhook.payload.queue</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>

    <!-- Dashboard Action -->
    <record id="action_vuln_fw_nvd_dashboard" model="ir.actions.act_window">
        <field name="name">NVD Dashboard</field>
        <field name="res_model">vuln.fw.nvd.api.connector</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Welcome to NVD Vulnerability Management
            </p>
            <p>
                Monitor your NVD importers and synchronization status from this dashboard.
                Create and configure NVD importers to start collecting vulnerability data.
            </p>
        </field>
    </record>

    <!-- Reference Action -->
    <record id="action_vuln_fw_nvd_reference" model="ir.actions.act_window">
        <field name="name">References</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">vuln.fw.nvd.reference</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>

    <!-- Sync Log Action -->
    <record id="action_vuln_fw_nvd_sync_log" model="ir.actions.act_window">
        <field name="name">Sync Logs</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">vuln.fw.nvd.sync.log</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>

    <!-- Configuration Menu Items -->
    <!-- Dashboard Menu Item -->
    <menuitem 
        id="menu_nvd_dashboard"
        name="ðŸ“± Dashboard"
        parent="menu_nvd_root"
        action="action_vuln_fw_nvd_dashboard"
        sequence="10"/>

    <menuitem
        id="menu_nvd_connector"
        name="Connectors"
        parent="menu_nvd_config"
        action="action_vuln_fw_nvd_connector"
        sequence="10"/>

    <menuitem
        id="menu_nvd_reference"
        name="References"
        parent="menu_nvd_config"
        action="action_vuln_fw_nvd_reference"
        sequence="20"/>

    <menuitem
        id="menu_nvd_sync_log"
        name="Sync Logs"
        parent="menu_nvd_reporting"
        action="action_vuln_fw_nvd_sync_log"
        sequence="10"/>

    <!-- Webhooks Menu -->
    <menuitem
        id="menu_nvd_webhooks"
        name="ðŸ”— Webhooks"
        parent="menu_nvd_root"
        sequence="30"/>

    <menuitem
        id="menu_nvd_webhook"
        name="Outbound Webhooks"
        parent="menu_nvd_webhooks"
        action="action_vuln_fw_nvd_webhook"
        sequence="10"/>

    <menuitem
        id="menu_nvd_webhook_receivers"
        name="Inbound Receivers"
        parent="menu_nvd_webhooks"
        action="action_vuln_fw_nvd_webhook_receiver"
        sequence="20"/>

    <menuitem
        id="menu_nvd_webhook_allowed_hosts"
        name="ðŸ›¡ï¸ Allowed Hosts"
        parent="menu_nvd_webhooks"
        action="action_vuln_fw_nvd_webhook_allowed_host"
        sequence="25"/>

    <menuitem
        id="menu_nvd_webhook_blocked_hosts"
        name="ðŸš« Blocked Hosts Review"
        parent="menu_nvd_webhooks"
        action="action_vuln_fw_nvd_webhook_blocked_host"
        sequence="26"/>

    <menuitem
        id="menu_nvd_webhook_logs"
        name="Webhook Logs"
        parent="menu_nvd_webhooks"
        action="action_vuln_fw_nvd_webhook_log"
        sequence="30"/>

    <menuitem
        id="menu_nvd_webhook_payload_queue"
        name="ðŸ“¬ Payload Queue"
        parent="menu_nvd_webhooks"
        action="action_vuln_fw_nvd_webhook_payload_queue"
        sequence="40"/>

</odoo>
